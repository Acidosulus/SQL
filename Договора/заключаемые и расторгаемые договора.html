<!DOCTYPE html>
<html>
<head>
<meta charset="windows-1251"/><style>
table {border: medium solid #6495ed;border-collapse: collapse;width: 100%;} th{font-family: monospace;border: thin solid #6495ed;padding: 5px;background-color: #D0E3FA;}th{text-align: left;}td{font-family: sans-serif;border: thin solid #6495ed;padding: 5px;text-align: center;}.odd{background:#e8edff;}img{padding:5px; border:solid; border-color: #dddddd #aaaaaa #aaaaaa #dddddd; border-width: 1px 2px 2px 1px; background-color:white;}</style>
</head>
<body>
<table><tr><th colspan="4"><pre><code>select periods.*,<br>		begins = (select sum(1) from stack.[Договор] where year([Начало договора])=periods.year and month([Начало договора])=periods.month),<br>		ends = (select sum(1) from stack.[Договор] where year([Дата расторжения])=periods.year and month([Дата расторжения])=periods.month)<br>from (<br>select distinct year(dates) as year, month(dates) as month<br>	from (<br>									select [Начало договора] as dates from stack.[Договор]<br>									union all<br>									select [Дата подписания] as dates from stack.[Договор]<br>									union all<br>									select [Окончание] as dates from stack.[Договор]<br>									union all<br>									select [Дата расторжения] as dates from stack.[Договор]) as dts<br>	where dates is not null								<br>) as periods<br>order by periods.year, periods.month<br></code></pre></th></tr><tr><th>year</th><th>month</th><th>begins</th><th>ends</th></tr><tr class="odd"><td>2022</td><td>1</td><td>&nbsp;</td><td>1</td></tr>
<tr><td>2022</td><td>8</td><td>274</td><td>323</td></tr>
<tr class="odd"><td>2022</td><td>9</td><td>5820</td><td>125</td></tr>
<tr><td>2022</td><td>10</td><td>45</td><td>46</td></tr>
<tr class="odd"><td>2022</td><td>11</td><td>42</td><td>27</td></tr>
<tr><td>2022</td><td>12</td><td>23</td><td>49</td></tr>
<tr class="odd"><td>2023</td><td>1</td><td>39</td><td>36</td></tr>
<tr><td>2023</td><td>2</td><td>30</td><td>28</td></tr>
<tr class="odd"><td>2023</td><td>3</td><td>24</td><td>80</td></tr>
<tr><td>2023</td><td>4</td><td>33</td><td>32</td></tr>
<tr class="odd"><td>2023</td><td>5</td><td>26</td><td>30</td></tr>
<tr><td>2023</td><td>6</td><td>28</td><td>26</td></tr>
<tr class="odd"><td>2023</td><td>7</td><td>48</td><td>26</td></tr>
<tr><td>2023</td><td>8</td><td>60</td><td>43</td></tr>
<tr class="odd"><td>2023</td><td>9</td><td>21</td><td>21</td></tr>
<tr><td>2023</td><td>10</td><td>28</td><td>15</td></tr>
<tr class="odd"><td>2023</td><td>11</td><td>30</td><td>26</td></tr>
<tr><td>2023</td><td>12</td><td>31</td><td>19</td></tr>
<tr class="odd"><td>2024</td><td>1</td><td>18</td><td>19</td></tr>
<tr><td>2024</td><td>2</td><td>30</td><td>17</td></tr>
<tr class="odd"><td>2024</td><td>3</td><td>33</td><td>10</td></tr>
<tr><td>2024</td><td>4</td><td>21</td><td>1</td></tr>
<tr class="odd"><td>2024</td><td>9</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>2024</td><td>12</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="odd"><td>2025</td><td>11</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>2045</td><td>1</td><td>&nbsp;</td><td>2</td></tr>
<tr class="odd"><td>2045</td><td>2</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>2045</td><td>5</td><td>&nbsp;</td><td>18</td></tr>
<tr class="odd"><td>2045</td><td>7</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td>2045</td><td>10</td><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr class="odd"><td>2045</td><td>12</td><td>&nbsp;</td><td>1</td></tr>
</table></body></html>